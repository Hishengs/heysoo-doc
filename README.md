## 介绍

> Heysoo 是一个底层基于 [Koa](http://koajs.com) 进行开发的典型 MVC 框架。它内置了一个 MVC 框架所需的元素，包括模型(M)、视图层(V)、控制器(C)，以及路由，静态文件伺服，定时器等等。在 Heysoo 框架中，我们通过配置来加载我们需要的功能，实现可插拔式的应用。我们相信，通过良好的配置及约定，能够构建出稳定有序的服务。

## 安装
```bash
npm install heysoo --save
```

## hello world
通过 heysoo 启动一个 web 服务十分简单。
```js
const Heysoo = require('heysoo');
const app = new Heysoo();

app.use(async ctx => {
  ctx.body = 'hello, world.';
});

app.start();
```
此时访问 localhost:86 即可。

## 进一步配置
首先介绍一下一个典型的 Heysoo 项目的目录结构：
```js
—— root
   ├── app                   // 主要应用目录
   |   ├── controller
   |   ├── service
   |   ├── view
   |   ├── model
   |   ├── static
   |   ├── schedule
   |   ├── router.js         // 全局路由配置
   ├── node_modules
   ├── index.js              // 启动文件
   ├── config.js             // 项目配置文件
   ├── package.json
```
下面我们通过一步一步修改的方式完成以上所有功能的配置。
首先，编写一个简单的配置文件 `config.js`：
```js
module.exports = {
  host: 'localhost',
  port: 91,                 // 默认端口是86，此处修改为你自己的端口
  folder: {                 // 我们可以通过 folder 配置参数修改我们的应用目录及子模块目录名称
    app: 'application',     // 默认 app
    controller: 'c',        // 默认 controller
    service: 's',           // 默认 service
    model: 'm',             // 默认 model
    view: 'v',              // 默认 view
    static: 'p',            // 默认 static
    schedule: 'sc'          // 默认 schedule
  }
}
```
> 更详细的配置参见 [`配置`](./#/config) 模块。

此时，我们的项目目录结构变成这样：
```js
── root
   ├── application
   |   ├── c
   |   ├── s
   |   ├── v
   |   ├── m
   |   ├── p
   |   ├── sc
   |   ├── router.js
   ├── node_modules
   ├── index.js
   ├── config.js
```
> 注意：所有的目录都不是必要的，在此示例中我们仅仅会用到 c(控制器) 这个目录来作介绍。

接着，编写路由配置文件 `application/router.js`：
```js
module.exports = app => {
  app.get('/',app.controller.home.index);
}
```
在这里，我们简单地将根路径指向 home 控制器对应的方法，输出一句问候语。在 c 目录下添加我们的控制器文件 `application/c/home.js`：
```js
module.exports = app => {
  class HomeController extends app.Controller {

    index (){
      this.ctx.body = 'hello, heysoo';
    }
    
  }
  return HomeController;
}
```

启动我们的应用 `node index.js`，访问 `http://localhost:91`，将看到浏览器输出 `hello, heysoo`。


## 依赖说明
Node
> Heysoo 对 Node 版本最低要求是 7.6.0 +（为了使用最新的 async/await 特性）。
如果你的 Node 版本比较低，可以考虑通过 babel 进行 polyfill，参见 [如何 polyfill？](/FAQ?id=%E5%A6%82%E4%BD%95-polyfill%EF%BC%9F)。

> Node 最新 LTS 版本已经到了 8.9.1，后端语言不像浏览器，建议尽可能升级到比较新的版本并拥抱新的语言特性。

## 特性
### <svg t="1517075302816" class="icon" style="width: 1em; height: 1em; vertical-align: middle; fill: currentcolor; overflow: hidden; font-size: 28px;" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="3885" data-spm-anchor-id="a313x.7781069.0.i6"><path d="M655.872 960a61.952 61.952 0 0 1-45.376-19.136c-14.912-16.192-62.272-58.24-100.992-58.24-38.464 0-86.528 42.304-100.352 57.216a62.144 62.144 0 0 1-68.224 14.144l-1.28-0.576-117.76-65.088-1.088-0.832a55.552 55.552 0 0 1-18.944-67.52c0.064-0.192 10.816-24.768 10.816-47.168 0-67.968-56-123.392-124.8-123.392h-4.16l-0.768 0.064c-19.712 0-35.776-17.344-40.896-44.096C41.6 603.264 32 552.448 32 512.384c0-40 9.6-90.88 10.048-92.992 5.184-27.136 21.568-44.48 41.664-44.096h4.16c68.8 0 124.8-55.296 124.8-123.328 0-22.4-10.752-46.976-10.88-47.232a55.424 55.424 0 0 1 19.136-67.456l1.216-0.832 124.224-67.456 1.344-0.576a63.36 63.36 0 0 1 67.968 13.952c14.656 15.232 61.184 54.784 98.816 54.784 37.312 0 83.52-38.784 98.112-53.76a63.616 63.616 0 0 1 68.032-13.376l1.28 0.576 120 65.92 1.216 0.832a55.424 55.424 0 0 1 19.072 67.456c-0.128 0.192-10.88 24.768-10.88 47.168 0 67.968 56 123.328 124.8 123.328h4.16c19.968-0.384 36.416 17.024 41.6 44.096 0.512 2.112 10.112 52.992 10.112 92.992 0 40.064-9.6 90.88-10.048 92.992-5.184 27.136-21.632 44.48-41.6 44.032h-4.16c-68.8 0-124.8 55.36-124.8 123.392 0 22.464 10.752 46.976 10.88 47.232a55.36 55.36 0 0 1-19.072 67.392l-1.28 0.896-122.048 66.688-1.344 0.512a56.32 56.32 0 0 1-22.656 4.48z m-6.016-64.832a8.192 8.192 0 0 0 3.648 0.96h0.192l112.128-61.056c-2.688-6.208-15.04-36.16-15.04-67.584 0-93.76 75.008-170.56 169.024-175.296 1.344-7.36 8.704-48.832 8.704-79.808s-7.296-72.384-8.704-79.744c-94.016-4.864-169.024-81.664-169.024-175.36 0-31.424 12.416-61.44 15.104-67.648l-110.4-60.352h-0.448a8.448 8.448 0 0 0-4.16 1.088 309.12 309.12 0 0 1-40.832 33.728c-33.984 23.552-66.176 35.456-95.552 35.456-29.76 0-62.144-12.16-96.384-36.16a312.064 312.064 0 0 1-41.024-34.432 9.088 9.088 0 0 0-4.224-1.024H372.48l-114.304 61.76c2.752 6.272 15.104 36.288 15.104 67.584 0 93.696-75.008 170.496-169.024 175.36-1.408 7.36-8.704 48.704-8.704 79.744s7.36 72.384 8.704 79.744c94.016 4.8 169.024 81.6 169.024 175.36 0 31.424-12.48 61.632-15.104 67.712l108.16 59.52h0.256a8 8 0 0 0 3.584-0.896c2.048-2.112 18.176-19.008 41.408-35.776 34.688-25.088 67.648-37.76 97.92-37.76 30.656 0 63.872 12.928 98.752 38.464 23.36 17.152 39.616 34.24 41.6 36.416z m-137.984-223.104c-88.32 0-160.192-71.68-160.192-159.808s71.872-159.744 160.192-159.744c88.384 0 160.256 71.616 160.256 159.744s-71.872 159.808-160.256 159.808z m0-255.744a96 96 0 0 0 0 191.808 95.936 95.936 0 0 0 0-191.808z" p-id="3886" fill="#515151" data-spm-anchor-id="a313x.7781069.0.i5" class="selected"></path></svg> 可配置，可拆卸
Heysoo 最大的特点是所有的功能模块几乎都可以配置，可拆卸，是否使用可以完全由你自己决定，不需要的功能模块在应用启动时并不会加载。假设你将所有的功能模块禁用，那它就只是一个简单的增强版的 Koa，仅此而已。

### <svg t="1517075594440" class="icon" style="width: 1em; height: 1em;vertical-align: middle;fill: currentColor;overflow: hidden; font-size: 28px;" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="6682"><path d="M281.674 253.424c11.553-14.585 24.288-28.14 38.208-40.267l-68.978-69.013c-10.828-10.867-28.404-10.867-39.275 0-10.831 10.831-10.831 28.404 0 39.235l70.046 70.043zM506.013 142.469c0.268 0 0.494 0 0.802 0 9.109 0 18.109 0.571 26.955 1.487l0-93.986c0-15.327-12.432-27.757-27.76-27.757s-27.721 12.429-27.721 27.757l0 93.968c8.846-0.895 17.842-1.469 26.956-1.469 0.27 0 0.534 0 0.762 0zM730.414 253.388l69.971-70.007c10.866-10.831 10.866-28.404 0-39.235-10.794-10.867-28.405-10.867-39.277 0l-69.018 69.013c13.958 12.123 26.695 25.664 38.324 40.227zM213.494 450.225c0-13.403 1.07-26.519 2.633-39.483l-98.682 0c-15.289 0-27.722 12.432-27.722 27.757 0 15.328 12.434 27.757 27.722 27.757l96.393 0c-0.229-5.28-0.345-10.581-0.345-16.033zM894.563 410.745l-98.643 0c1.6 12.964 2.633 26.082 2.633 39.483 0 5.45-0.115 10.753-0.305 16.033l96.315 0c15.332 0 27.722-12.429 27.722-27.757s-12.39-27.757-27.722-27.757zM745.017 638.262c-11.286 16.547-23.218 30.843-34.695 43.77l50.787 50.829c10.868 10.831 28.483 10.831 39.277 0 10.866-10.867 10.866-28.404 0-39.275l-55.37-55.324zM211.627 693.585c-10.831 10.867-10.831 28.404 0 39.275 10.868 10.831 28.448 10.831 39.275 0l50.83-50.863c-11.475-12.889-23.412-27.222-34.699-43.731l-55.403 55.324zM760.039 450.225c0.037-57.556-19.138-110.785-51.438-153.414-28.33-37.442-66.806-66.802-111.379-84.036l0.229-1.222-19.026-5.586c-14.798-4.29-30.051-7.265-45.605-8.867l-2.211-0.246-0.075 0-0.079-0.019c-7.623-0.724-15.557-1.279-23.83-1.279l-1.218 0c-8.276 0-16.207 0.557-23.833 1.279l-0.115 0.019-2.286 0.246c-15.535 1.6-30.791 4.575-45.549 8.867l-18.416 5.374 0.19 1.222c-44.802 17.214-83.505 46.651-111.99 84.244-32.258 42.628-51.438 95.854-51.438 153.414 0 41.274 7.132 75.207 18.227 103.29 16.661 42.114 42.094 70.559 62.533 92.138 10.22 10.754 19.22 19.941 25.317 27.795 6.254 7.892 9.265 13.995 10.141 18.837 4.459 23.565 4.917 53.306 4.917 60.854l0 2.174c0 34.085 27.609 61.617 61.659 61.655l142.51 0c34.092-0.037 61.659-27.609 61.659-61.655l0-2.097c-0.037-7.474 0.458-37.291 4.919-60.893 0.608-3.278 2.058-7.017 4.917-11.591 4.88-7.97 14.11-17.883 25.548-29.819 17.083-17.959 38.815-40.604 56.091-72.805 17.312-32.161 29.703-73.706 29.626-127.882zM701.813 537.676c-13.614 34.336-34.053 57.575-53.763 78.391-9.841 10.411-19.487 20.095-27.911 30.812-8.311 10.562-15.745 22.65-18.606 37.481-5.377 28.94-5.607 59.978-5.638 68.862 0 1.181 0 1.828 0 2.096-0.037 10.295-8.314 18.606-18.608 18.606l-142.51 0c-5.223 0-9.761-2.059-13.194-5.45-3.391-3.434-5.412-7.934-5.412-13.154 0-0.268 0-0.953 0-2.172-0.037-8.957-0.306-39.921-5.682-68.783-1.828-9.797-5.834-18.571-10.674-26.348-8.579-13.612-19.559-24.819-30.889-36.832-17.116-17.842-35.232-37.119-49.341-63.41-14.07-26.309-24.517-59.745-24.557-107.54 0.037-47.947 15.862-91.95 42.706-127.427 26.845-35.442 64.595-62.209 108.175-75.246l5.377-1.638c10.524-2.708 21.315-4.861 32.429-6.026l0.075 0 2.06-0.229c6.519-0.627 12.847-1.03 19.103-1.066l1.105 0.115 1.106-0.076c6.212 0 12.579 0.42 19.063 1.03l-0.079 0 2.137 0.229 0.037 0c11.093 1.163 21.887 3.277 32.372 6.026l5.451 1.638c43.582 13.037 81.329 39.807 108.175 75.246 26.801 35.478 42.666 79.482 42.666 127.427 0.003 36.409-6.094 64.511-15.169 87.446zM532.782 197.107l0.079 0zM479.17 197.107l0 0c0 0 0.037 0 0.075 0l-0.075 0zM576.706 833.825l-141.369 0c-14.604 0-26.499 11.822-26.499 26.539 0 14.564 11.899 26.465 26.499 26.465l141.369 0c14.604 0 26.499-11.899 26.499-26.465 0-14.721-11.899-26.539-26.499-26.539zM576.706 900.704l-141.369 0c-14.604 0-26.499 11.857-26.499 26.464 0 14.678 11.899 26.539 26.499 26.539l141.369 0c14.604 0 26.499-11.857 26.499-26.539 0-14.605-11.899-26.464-26.499-26.464zM518.406 968.116l-72.805 0c0 0.801-0.154 1.561-0.154 2.404 0 14.643 22.498 26.499 43.297 26.499l34.546 0c20.818 0 43.277-11.857 43.277-26.499 0-0.837-0.115-1.6-0.115-2.404l-48.044 0z" p-id="6683" fill="#515151" data-spm-anchor-id="a313x.7781069.0.i12"></path></svg> 他山之石，可以攻玉
Heysoo 并不是一个重新造轮子的 MVC 框架，我们的目标是尽可能地使用优秀的开源库来实现我们想要的功能。Heysoo 的基础功能是基于 Koa 实现的，在其基础上进行功能增强，而所有的这些功能都是可以拆卸的。

### <svg t="1517075782927" class="icon" style="width: 1em; height: 1em;vertical-align: middle;fill: currentColor;overflow: hidden;font-size: 28px;" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="7480"><path d="M506.695692 747.005338c-72.449056 0-140.125411-27.776623-190.56315-78.213339l-8.91095-8.91095c-51.137681-51.150984-78.914304-119.792317-78.200036-193.287191 0.714268-72.991408 29.377074-141.448546 80.685647-192.758142l139.134851-139.148154c10.153244-10.153244 28.133757-10.153244 38.288025 0l354.195951 354.195951c5.076622 5.076622 7.931646 11.964496 7.931646 19.144012 0 7.178493-2.855024 14.066367-7.931646 19.144012L702.191178 666.306388C650.155035 718.343555 580.719616 747.005338 506.695692 747.005338zM467.986065 192.119599 347.995227 312.12374c-41.221844 41.221844-64.23907 96.27367-64.821331 155.00019-0.567935 58.83192 21.563108 113.684202 62.349023 154.471141l8.91095 8.909927c40.204677 40.204677 94.2772 62.350047 152.261822 62.350047 59.559491 0 115.391077-23.030529 157.207461-64.833611l119.991862-119.991862L467.986065 192.119599z" p-id="7481" fill="#515151"></path><path d="M393.051399 357.180935c-3.463891 0-6.941086-1.322112-9.585309-3.966335-5.275143-5.288446-5.275143-13.868869 0.013303-19.144012l9.572006-9.572006c5.288446-5.288446 13.868869-5.288446 19.156292 0 5.275143 5.288446 5.275143 13.868869-0.013303 19.144012l-9.572006 9.572006C399.979182 355.858824 396.515291 357.180935 393.051399 357.180935z" p-id="7482" fill="#515151"></path><path d="M349.885274 528.758686c-6.028297 0-11.528568-4.046153-13.101389-10.153244-13.048177-50.54314-5.447059-105.236809 20.862143-150.027945 3.781116-6.438643 12.069897-8.620331 18.521842-4.825912 6.451946 3.781116 8.607028 12.084223 4.825912 18.521842-22.700001 38.684044-29.257348 85.895299-17.992793 129.562844 1.876744 7.245008-2.485611 14.622022-9.717316 16.486486C352.14678 528.626679 351.009887 528.758686 349.885274 528.758686z" p-id="7483" fill="#515151"></path><path d="M101.402993 950.84998c-1.387603 0-2.816139-0.106424-4.243651-0.343831-14.740726-2.325975-24.828478-16.129352-22.528086-30.883381 0.859577-5.525853 22.25077-136.219451 119.964232-184.158277 68.707848-33.686217 90.720188-112.535029 90.932012-113.328092 3.886517-14.396895 18.720364-22.99062 33.130561-19.129686 14.423501 3.834328 23.017226 18.574031 19.222807 32.998555-1.110287 4.203742-28.107151 103.305831-119.436206 148.08571-72.224951 35.430954-90.152253 142.828986-90.324168 143.913691C125.993041 941.330162 114.491079 950.84998 101.402993 950.84998z" p-id="7484" fill="#515151"></path><path d="M563.717384 276.639574c-6.927783 0-13.854543-2.6432-19.142989-7.931646-10.576893-10.576893-10.576893-27.711132 0-38.287001L709.634708 65.35959c10.562567-10.576893 27.723412-10.576893 38.287001 0 10.576893 10.57587 10.576893 27.711132 0 38.287001L582.861396 268.707928C577.586253 273.996374 570.644143 276.639574 563.717384 276.639574z" p-id="7485" fill="#515151"></path><path d="M726.450698 439.372889c-6.927783 0-13.854543-2.644223-19.142989-7.931646-10.576893-10.576893-10.576893-27.711132 0-38.287001l165.060313-165.060313c10.562567-10.576893 27.723412-10.576893 38.287001 0 10.576893 10.57587 10.576893 27.710109 0 38.287001L745.594711 431.441243C740.319567 436.728666 733.378481 439.372889 726.450698 439.372889z" p-id="7486" fill="#515151"></path></svg> 插件化
你可以通过 Heysoo 提供的 `app.hook` 钩子功能来引入你自己实现的插件。例如如果你觉得 Heysoo 自带的数据库功能不是你想要的，你完全可以禁用它，之后引入你自己实现的数据库插件模块。

### <svg t="1517075847936" class="icon" style="width: 1em; height: 1em;vertical-align: middle;fill: currentColor;overflow: hidden;font-size: 28px;" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="8023"><path d="M691.192163 460.805119c-70.546545 0-127.987201-57.440656-127.987201-127.987201s57.440656-127.987201 127.987201-127.987201 127.987201 57.440656 127.987201 127.987201-57.440656 127.987201-127.987201 127.987201zM691.192163 256.025597c-42.338166 0-76.792321 34.454155-76.792321 76.792321s34.454155 76.792321 76.792321 76.792321 76.792321-34.454155 76.792321-76.792321-34.454155-76.792321-76.792321-76.792321z" p-id="8024" fill="#515151"></path><path d="M25.658716 1023.948805c-6.655334 0-13.208279-2.610939-18.122988-7.474453-7.013699-7.013699-9.368663-17.508649-5.938606-26.826117 78.788921-216.605539 161.622238-326.469753 246.144986-326.469753 27.90121 0 53.959404 11.979602 77.560244 35.529247 37.269873 37.269873 38.60094 74.386161 33.174283 98.959704-17.09909 77.20188-126.144186 152.816718-324.063594 224.79672-2.866913 1.023898-5.836216 1.535846-8.754325 1.535846zM247.793302 714.322168c-25.341466 0-55.188081 22.218578-86.263374 64.249575-30.563344 41.314269-61.280272 100.188381-91.536446 175.444856 68.345165-27.491651 123.277272-55.392861 163.772423-83.191681 54.624938-37.525847 70.80252-66.553345 74.744526-84.266773s-2.406159-34.658934-19.40286-51.655634c-13.822618-13.822618-27.338066-20.529147-41.365463-20.529147z" p-id="8025" fill="#515151"></path><path d="M998.361446 0.051195c-132.850715 0-251.213279 22.525747-351.913609 66.962904-82.986901 36.655534-154.045395 88.055194-211.230077 152.867913-10.648535 12.081992-20.529147 24.317568-29.693031 36.60434-44.129987 2.918108-89.283872 20.477952-134.335366 52.218778-38.140186 26.826117-76.433957 63.993601-113.908609 110.427357-62.969703 78.020998-101.673033 154.966903-103.311269 158.192181-5.580242 11.211679-2.252575 24.829517 7.884012 32.150385 4.505149 3.276472 9.778222 4.863514 15.0001 4.863514 6.552945 0 13.105889-2.508549 18.071793-7.423258 0.255974-0.255974 24.727127-24.317568 66.450955-47.918408 34.40296-19.454055 87.440856-42.338166 151.588041-46.382562 16.228777 41.519048 62.662534 91.178082 84.932307 113.447855s71.928807 68.70353 113.447855 84.932307c-4.044396 64.147185-26.928507 117.185081-46.382562 151.588041-23.652035 41.775022-47.662434 66.194981-47.867213 66.39976-8.856714 8.856714-9.983002 22.884112-2.662134 33.071893 4.965903 6.860114 12.747525 10.648535 20.785121 10.648535 3.890811 0 7.781622-0.870313 11.416458-2.713329 3.225277-1.638236 80.171183-40.341566 158.192181-103.311269 46.433757-37.474653 83.60124-75.768423 110.427357-113.908609 31.740826-45.10269 49.249475-90.205379 52.218778-134.335366 12.235576-9.112689 24.471153-18.993301 36.60434-29.693031 64.812719-57.184682 116.212379-128.243176 152.867913-211.230077 44.437156-100.649135 66.962904-219.062894 66.962904-351.913609l0-25.59744-25.59744 0zM159.123769 502.170583c48.788721-70.80252 123.379662-158.60174 207.441656-186.19578-33.225477 58.208579-50.426957 111.656034-56.621538 145.547045-59.334867 3.634837-110.478552 20.887511-150.820118 40.648735zM521.890693 864.732727c19.761224-40.341566 37.013899-91.434057 40.59754-150.717728 33.839816-6.194581 87.338466-23.39606 145.49585-56.570343-27.645235 83.908409-115.393261 158.49935-186.144586 207.288071zM770.237058 550.39616c-106.485351 93.942606-216.759124 115.188481-232.629537 115.188481-0.10239 0-10.59734-0.20478-38.856914-20.119588-19.710029-13.873813-42.69653-33.635036-64.607939-55.546445s-41.672633-44.89791-55.546445-64.607939c-19.914809-28.259574-20.119588-38.754525-20.119588-38.856914 0-15.870413 21.245875-126.144186 115.188481-232.629537 112.423958-127.372863 284.489951-197.049095 498.842916-202.219778-5.170683 214.352965-74.79572 386.418958-202.219778 498.842916z" p-id="8026" fill="#515151"></path></svg> 拥抱 ES2015 和 async/await
在 Node 环境下编写代码，我们没有理由不使用 ES2015，同时通过适当的配置(babel)我们就可以使用更加方便的 async/await 特性代替繁琐的 promise / generator / co 等。
